{"version":3,"sources":["board.js","uct.js","index.js"],"names":["createNewBoard","makeMove","x","y","move","board","rowToChange","map","r","i","checkWin","getFreeCells","concat","row","cell","j","filter","length","checkDraw","reduce","prev","acc","uct","turn","nRollouts","C","rootNode","createNode","search","children","childrenKeys","Object","keys","max","curr","value","getRandomIntInclusive","min","Math","ceil","floor","random","count","selectMove","node","initTurn","moves","uctVals","key","child","explorationPart","Infinity","sqrt","log","uctVal","func","bestVal","bestMoves","_","chosenIndex","chosenMove","chosenChild","won","Board","iMove","jMove","childNode","newBoard","newTurn","score","toggleTurn","createElemWithClassName","tagName","elem","document","createElement","classNames","forEach","name","classList","add","createX","createO","draw","elems","cellElem","querySelector","Array","from","e","appendChild","playMove","win","handleEnd","showTurn","innerHTML","clearBoardElem","cellElems","childNodes","reverse","removeChild","winner","game","startButtonElem","disabled","clickToStartElem","style","opacity","gameResultElem","turnIndicator","startGame","target","N_ROLLOUTS","boardEl","querySelectorAll","addEventListener","el","id","split","parseInt","resMove","turn_","console","split_","i_","j_","setTimeout"],"mappings":"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","file":"src.e31bb0bc.js","sourceRoot":"../src","sourcesContent":["export function createNewBoard() {\n  return [\n    [\"\", \"\", \"\"],\n    [\"\", \"\", \"\"],\n    [\"\", \"\", \"\"]\n  ];\n}\n\nexport function makeMove(x, y, move, board) {\n  const rowToChange = [...board[y]];\n  rowToChange[x] = move;\n\n  return board.map((r, i) => (i === y ? rowToChange : r));\n}\n\nexport function checkWin(board) {\n  // horizontal\n  if (board[0][0] === board[0][1] && board[0][1] === board[0][2]) {\n    return board[0][0];\n  } else if (board[1][0] === board[1][1] && board[1][1] === board[1][2]) {\n    return board[1][0];\n  } else if (board[2][0] === board[2][1] && board[2][1] === board[2][2]) {\n    return board[2][0];\n  }\n  // vertical\n  else if (board[0][0] === board[1][0] && board[1][0] === board[2][0]) {\n    return board[0][0];\n  } else if (board[0][1] === board[1][1] && board[1][1] === board[2][1]) {\n    return board[0][1];\n  } else if (board[0][2] === board[1][2] && board[1][2] === board[2][2]) {\n    return board[0][2];\n  }\n  // diagonal\n  else if (board[0][0] === board[1][1] && board[1][1] === board[2][2]) {\n    return board[0][0];\n  } else if (board[0][2] === board[1][1] && board[1][1] === board[2][0]) {\n    return board[0][2];\n  }\n\n  return false;\n}\n\nexport function getFreeCells(board) {\n  return [].concat(\n    ...board.map((row, i) =>\n      row\n        .map((cell, j) => (cell === \"\" ? [i + 1, j + 1] : []))\n        .filter(x => x.length > 0)\n    )\n  );\n}\n\nexport function checkDraw(board) {\n  return (\n    board\n      .map(row => row.filter(cell => cell === \"\").length)\n      .reduce((prev, acc) => prev + acc, 0) === 0\n  );\n}\n","import * as Board from \"./board\";\n\nexport function uct(turn, board, nRollouts, C) {\n  const rootNode = createNode(turn);\n  for (let i = 0; i < nRollouts; ++i) {\n    search(rootNode, turn, turn, board, C);\n  }\n\n  const { children } = rootNode;\n  const childrenKeys = Object.keys(children);\n  return [\n    childrenKeys.reduce(\n      (max, curr) => (children[curr].value > children[max].value ? curr : max),\n      childrenKeys[0]\n    ),\n    rootNode\n  ];\n}\n\nfunction getRandomIntInclusive(min, max) {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nfunction createNode(turn) {\n  return { value: -1, count: 0, turn, children: {} };\n}\n\nfunction selectMove(node, initTurn, moves, C) {\n  const uctVals = moves.map(move => {\n    const key = `${move[0]}-${move[1]}`;\n    if (typeof node.children[key] === \"undefined\") {\n      node.children[key] = createNode(node.turn === \"X\" ? \"O\" : \"X\");\n    }\n    const child = node.children[key];\n    const explorationPart =\n      child.count === 0\n        ? Infinity\n        : Math.sqrt(Math.log(node.count) / child.count);\n    const uctVal =\n      child.value +\n      C * (node.turn === initTurn ? explorationPart : -explorationPart);\n\n    return uctVal;\n  });\n\n  const func = Math[node.turn === initTurn ? \"max\" : \"min\"];\n  const bestVal = func(...uctVals);\n  const bestMoves = moves.filter((_, i) => uctVals[i] === bestVal);\n\n  const chosenIndex = getRandomIntInclusive(0, bestMoves.length - 1);\n  const chosenMove = bestMoves[chosenIndex];\n  const chosenChild = node.children[`${chosenMove[0]}-${chosenMove[1]}`];\n\n  return [chosenMove, chosenChild];\n}\n\nfunction search(node, turn, initTurn, board, C) {\n  const won = Board.checkWin(board);\n  if (won) {\n    const value = won === initTurn ? 1 : -1;\n    node.value = value;\n\n    return value;\n  }\n  if (Board.checkDraw(board)) {\n    node.value = 0;\n    return 0;\n  }\n\n  const moves = Board.getFreeCells(board);\n\n  const [[iMove, jMove], childNode] = selectMove(node, initTurn, moves, C);\n\n  const newBoard = Board.makeMove(jMove - 1, iMove - 1, turn, board);\n  const newTurn = turn === \"X\" ? \"O\" : \"X\";\n\n  const score = search(childNode, newTurn, initTurn, newBoard, C);\n\n  // backup values\n  childNode.value =\n    (childNode.count * childNode.value + score) / (childNode.count + 1);\n  // update node count\n  node.count += 1;\n\n  return score;\n}\n","import * as Board from \"./board\";\nimport { uct } from \"./uct\";\n\nfunction toggleTurn(turn) {\n  return turn === \"O\" ? \"X\" : \"O\";\n}\n\nfunction createElemWithClassName(tagName, ...classNames) {\n  const elem = document.createElement(tagName);\n  classNames.forEach(name => elem.classList.add(name));\n  return elem;\n}\n\nfunction createX() {\n  return [\n    createElemWithClassName(\"div\", \"x-cell-line\", \"rotate45\"),\n    createElemWithClassName(\"div\", \"x-cell-line\", \"rotate45neg\")\n  ];\n}\n\nfunction createO() {\n  return [createElemWithClassName(\"div\", \"o-cell\")];\n}\n\nfunction draw(turn, i, j) {\n  const elems = turn === \"X\" ? createX() : createO();\n  const cellElem = document.querySelector(`#cell-${i}-${j}`);\n\n  Array.from(elems).forEach(e => cellElem.appendChild(e));\n}\n\nfunction playMove(i, j, turn, board) {\n  draw(turn, i, j);\n  board = Board.makeMove(j - 1, i - 1, turn, board);\n  const win = Board.checkWin(board);\n  if (win) {\n    handleEnd(win);\n    return [win, board];\n  }\n  if (Board.checkDraw(board)) {\n    handleEnd();\n    return [\"\", board];\n  }\n  return [false, board];\n}\n\nfunction showTurn(turn) {\n  document.querySelector(\"#current-turn\").innerHTML = turn;\n}\n\nfunction clearBoardElem() {\n  cellElems.forEach(elem =>\n    Array.from(elem.childNodes)\n      .reverse()\n      .forEach(child => elem.removeChild(child))\n  );\n}\n\nfunction handleEnd(winner) {\n  game = false;\n  startButtonElem.disabled = false;\n  clickToStartElem.style.opacity = 1;\n\n  gameResultElem.innerHTML =\n    typeof winner === \"undefined\" ? \"Draw!\" : `${winner} won!`;\n  gameResultElem.style.opacity = 1;\n\n  turnIndicator.style.opacity = 0;\n}\n\nfunction startGame(e) {\n  board = Board.createNewBoard();\n  clearBoardElem();\n  e.target.disabled = true;\n  game = true;\n  showTurn(turn);\n  clickToStartElem.style.opacity = 0;\n  gameResultElem.style.opacity = 0;\n  turnIndicator.style.opacity = 1;\n}\n\nconst N_ROLLOUTS = 500;\nconst C = 1;\n\n// Game state\n// ================================================================\nlet board = Board.createNewBoard();\nlet turn = \"O\";\nlet game = false;\n// ================================================================\n// Elements\n// ================================================================\nlet boardEl = document.querySelector(\"#board\");\nlet cellElems = document.querySelectorAll(\".cell\");\nlet gameResultElem = document.querySelector(\"#game-result\");\nlet startButtonElem = document.querySelector(\"#start-button\");\nlet clickToStartElem = document.querySelector(\"#click-to-start\");\nlet turnIndicator = document.querySelector(\"#turn-indicator\");\n// ================================================================\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n  // Elements\n  // ================================================================\n  boardEl = document.querySelector(\"#board\");\n  cellElems = document.querySelectorAll(\".cell\");\n  gameResultElem = document.querySelector(\"#game-result\");\n  startButtonElem = document.querySelector(\"#start-button\");\n  clickToStartElem = document.querySelector(\"#click-to-start\");\n  turnIndicator = document.querySelector(\"#turn-indicator\");\n  // ================================================================\n\n  cellElems.forEach(el =>\n    el.addEventListener(\"click\", function(e) {\n      if (!game) return;\n\n      const { id } = e.target;\n      const split = id.split(\"-\");\n      const i = parseInt(split[1]);\n      const j = parseInt(split[2]);\n\n      let [resMove, newBoard] = playMove(i, j, turn, board);\n      board = newBoard;\n      if (resMove !== false) {\n        return;\n      }\n\n      const turn_ = toggleTurn(turn);\n      const [move] = uct(turn_, board, N_ROLLOUTS, C);\n      console.log(\"UCT finished: \", move);\n\n      showTurn(turn_);\n\n      const split_ = move.split(\"-\");\n      const i_ = parseInt(split_[0]);\n      const j_ = parseInt(split_[1]);\n\n      setTimeout(() => {\n        [resMove, newBoard] = playMove(i_, j_, turn_, board);\n        board = newBoard;\n        showTurn(turn);\n      }, 1000);\n    })\n  );\n\n  startButtonElem.addEventListener(\"click\", startGame);\n  startButtonElem.addEventListener(\"touchstart\", startGame);\n});\n"]}